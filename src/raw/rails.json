{"kind": "Listing", "data": {"modhash": "", "dist": 11, "children": [{"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "In this thread you can showcase your personal pet project to other redditors.\n\nNeed help with a specific problem or just wanna have some extra eyeballs on your code? Ask away!\n\nA suggested format to get you started:\n\n1. **Name of your project**\n2. **A short description**\n3. **Application stack**\n4. **Link to Live app**\n5. **Link to GitHub**\n6. **You experience level**\n7. **Other information or areas that you would like advice on**\n\n\u00a0\n\n^(Many thanks to Kritnc for getting the ball rolling.)", "author_fullname": "t2_6l4z3", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Personal Projects - Show off your own project and/or ask for advice", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "top_awarded_type": null, "hide_score": false, "name": "t3_gvu083", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.8, "author_flair_background_color": null, "subreddit_type": "public", "ups": 3, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 3, "approved_by": null, "author_premium": true, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1591219964.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;In this thread you can showcase your personal pet project to other redditors.&lt;/p&gt;\n\n&lt;p&gt;Need help with a specific problem or just wanna have some extra eyeballs on your code? Ask away!&lt;/p&gt;\n\n&lt;p&gt;A suggested format to get you started:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;Name of your project&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;A short description&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Application stack&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Link to Live app&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Link to GitHub&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;You experience level&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Other information or areas that you would like advice on&lt;/strong&gt;&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;\u00a0&lt;/p&gt;\n\n&lt;p&gt;&lt;sup&gt;Many thanks to Kritnc for getting the ball rolling.&lt;/sup&gt;&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": true, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": "moderator", "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "gvu083", "is_robot_indexable": true, "report_reasons": null, "author": "AutoModerator", "discussion_type": null, "num_comments": 1, "send_replies": false, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/gvu083/personal_projects_show_off_your_own_project_andor/", "parent_whitelist_status": "all_ads", "stickied": true, "url": "https://www.reddit.com/r/rails/comments/gvu083/personal_projects_show_off_your_own_project_andor/", "subreddit_subscribers": 44489, "created_utc": 1591191164.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "I have been programming in RoR since version 2.0, but I have never encountered a problem like this til now.  This is my second RoR API with React as the front end app. RoR v6.02\n\nThe problem is in one particular table **Invitations** which has, among many others, a string column originally named **state**.  I have many other tables with similar columns (same name, same type) that work fine, BUT, the **Invitations** table is in a world of its own.  \n\n\n* 1 the column does exist in the table.  I can see it and populate it using\npgAdmin 4.\n* 2 I can see the field in the log, with the proper values.  \n* 3 I have it in my parameters whitelist.  \n* 4 I can see it when printing params.inspect.\n\nIn the line immediately following the inspection, as in:\n\n    puts \"#{params.inspect}\"\n\n= \"... updated_at\"=&gt;\"2020-06-12T17:32:46.420Z\", \"state\"=&gt;\"invite\"} permitted: true&gt;}\n\n    puts  \"#{params.state}\"\n\n=NoMethodError (undefined method `state' for &lt;ActionController::Parameters...&gt;)\n\nAny code that executes after the whitelist gives me the same NoMethodError.  For example,\n\n    @state = params.state;\n    Invitation.update(invitation_params).\n\nI have looked all over the web for a similar problem but maybe I just don't know the right question.\n\nLastly, just in case, I renamed the column to **status**, but nothing changed except for the column name in the logs.\n\nAny ideas will be appreciated.\n\nP.S.  I have been working in digital electronics since 1954, with a degree in Electrical Engineering.  The first machine I worked on was a LGP-30 with 8k words of drum memory.  The OS was a graduate student with a cot (and miles of paper tape).  I am probably among the few survivors who knows how to program around drum latency :) /brag", "author_fullname": "t2_rdwcg", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "The case of the disappearing db column :(", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "top_awarded_type": null, "hide_score": false, "name": "t3_h7ww81", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.71, "author_flair_background_color": null, "subreddit_type": "public", "ups": 8, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 8, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": 1592009324.0, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1592037284.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;I have been programming in RoR since version 2.0, but I have never encountered a problem like this til now.  This is my second RoR API with React as the front end app. RoR v6.02&lt;/p&gt;\n\n&lt;p&gt;The problem is in one particular table &lt;strong&gt;Invitations&lt;/strong&gt; which has, among many others, a string column originally named &lt;strong&gt;state&lt;/strong&gt;.  I have many other tables with similar columns (same name, same type) that work fine, BUT, the &lt;strong&gt;Invitations&lt;/strong&gt; table is in a world of its own.  &lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;1 the column does exist in the table.  I can see it and populate it using\npgAdmin 4.&lt;/li&gt;\n&lt;li&gt;2 I can see the field in the log, with the proper values.&lt;br/&gt;&lt;/li&gt;\n&lt;li&gt;3 I have it in my parameters whitelist.&lt;br/&gt;&lt;/li&gt;\n&lt;li&gt;4 I can see it when printing params.inspect.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;In the line immediately following the inspection, as in:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;puts &amp;quot;#{params.inspect}&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;= &amp;quot;... updated_at&amp;quot;=&amp;gt;&amp;quot;2020-06-12T17:32:46.420Z&amp;quot;, &amp;quot;state&amp;quot;=&amp;gt;&amp;quot;invite&amp;quot;} permitted: true&amp;gt;}&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;puts  &amp;quot;#{params.state}&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;=NoMethodError (undefined method `state&amp;#39; for &amp;lt;ActionController::Parameters...&amp;gt;)&lt;/p&gt;\n\n&lt;p&gt;Any code that executes after the whitelist gives me the same NoMethodError.  For example,&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;@state = params.state;\nInvitation.update(invitation_params).\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;I have looked all over the web for a similar problem but maybe I just don&amp;#39;t know the right question.&lt;/p&gt;\n\n&lt;p&gt;Lastly, just in case, I renamed the column to &lt;strong&gt;status&lt;/strong&gt;, but nothing changed except for the column name in the logs.&lt;/p&gt;\n\n&lt;p&gt;Any ideas will be appreciated.&lt;/p&gt;\n\n&lt;p&gt;P.S.  I have been working in digital electronics since 1954, with a degree in Electrical Engineering.  The first machine I worked on was a LGP-30 with 8k words of drum memory.  The OS was a graduate student with a cot (and miles of paper tape).  I am probably among the few survivors who knows how to program around drum latency :) /brag&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "h7ww81", "is_robot_indexable": true, "report_reasons": null, "author": "donzzzzz", "discussion_type": null, "num_comments": 9, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/h7ww81/the_case_of_the_disappearing_db_column/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/h7ww81/the_case_of_the_disappearing_db_column/", "subreddit_subscribers": 44489, "created_utc": 1592008484.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "Does anyone have a solution for the rails routes command that doesn't require grepping a specific controller or using the expand flag, that would pretty up the output of the rails routes command? It seems to be thrown off by action mail and active storage routes because of their length. Sure, I could use the expanded flag but then the console window can go for days. I would like to just see the formatting locked like it used to be or maybe even suppress the action mail stuff. \n\nhttps://preview.redd.it/5pyumixzoh451.png?width=1706&amp;format=png&amp;auto=webp&amp;s=c4e08fe5012b36a9f1957842de27ba785805d509", "author_fullname": "t2_5ntfrudj", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Rails Routes in Rails 6 looks kinda terrible in the terminal", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "top_awarded_type": null, "hide_score": false, "media_metadata": {"5pyumixzoh451": {"status": "valid", "e": "Image", "m": "image/png", "p": [{"y": 82, "x": 108, "u": "https://preview.redd.it/5pyumixzoh451.png?width=108&amp;crop=smart&amp;auto=webp&amp;s=78cab55daaf55d842d70839fa926f2df8443b230"}, {"y": 164, "x": 216, "u": "https://preview.redd.it/5pyumixzoh451.png?width=216&amp;crop=smart&amp;auto=webp&amp;s=853f987d39d7fcc030c7cebcf168229aacc81deb"}, {"y": 243, "x": 320, "u": "https://preview.redd.it/5pyumixzoh451.png?width=320&amp;crop=smart&amp;auto=webp&amp;s=c7a4ef0b30169090d49ba8eff353a9ba98c9e691"}, {"y": 487, "x": 640, "u": "https://preview.redd.it/5pyumixzoh451.png?width=640&amp;crop=smart&amp;auto=webp&amp;s=121ea4f68f1d6aa95fe372588c8b7f8ff3eac23b"}, {"y": 731, "x": 960, "u": "https://preview.redd.it/5pyumixzoh451.png?width=960&amp;crop=smart&amp;auto=webp&amp;s=2988f1eb794fe2a19d2be3d54b412410364fe0f6"}, {"y": 822, "x": 1080, "u": "https://preview.redd.it/5pyumixzoh451.png?width=1080&amp;crop=smart&amp;auto=webp&amp;s=9c06b94fee9b6b994bbc2ddccee1bc3c1c6b6209"}], "s": {"y": 1300, "x": 1706, "u": "https://preview.redd.it/5pyumixzoh451.png?width=1706&amp;format=png&amp;auto=webp&amp;s=c4e08fe5012b36a9f1957842de27ba785805d509"}, "id": "5pyumixzoh451"}}, "name": "t3_h7lozw", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.9, "author_flair_background_color": null, "subreddit_type": "public", "ups": 8, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 8, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1592000949.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": true, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;Does anyone have a solution for the rails routes command that doesn&amp;#39;t require grepping a specific controller or using the expand flag, that would pretty up the output of the rails routes command? It seems to be thrown off by action mail and active storage routes because of their length. Sure, I could use the expanded flag but then the console window can go for days. I would like to just see the formatting locked like it used to be or maybe even suppress the action mail stuff. &lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://preview.redd.it/5pyumixzoh451.png?width=1706&amp;amp;format=png&amp;amp;auto=webp&amp;amp;s=c4e08fe5012b36a9f1957842de27ba785805d509\"&gt;https://preview.redd.it/5pyumixzoh451.png?width=1706&amp;amp;format=png&amp;amp;auto=webp&amp;amp;s=c4e08fe5012b36a9f1957842de27ba785805d509&lt;/a&gt;&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "h7lozw", "is_robot_indexable": true, "report_reasons": null, "author": "rails_coder", "discussion_type": null, "num_comments": 16, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/h7lozw/rails_routes_in_rails_6_looks_kinda_terrible_in/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/h7lozw/rails_routes_in_rails_6_looks_kinda_terrible_in/", "subreddit_subscribers": 44489, "created_utc": 1591972149.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "  \nHow can I even begin troubleshooting this? it would help to know what the contents of the dropped messages were, or at least which method/process/dyno these dropped messages originated from.", "author_fullname": "t2_1szauu7h", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "heroku[logplex]: Error L10 (output buffer overflow): drain 'd.cfcd3264-7259-4b12-ac5b-016032978174' dropped 1 messages since 2020-06-12T14:40:59.280571+00:00.", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "top_awarded_type": null, "hide_score": false, "name": "t3_h7lyqq", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.86, "author_flair_background_color": null, "subreddit_type": "public", "ups": 5, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 5, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1592001868.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;How can I even begin troubleshooting this? it would help to know what the contents of the dropped messages were, or at least which method/process/dyno these dropped messages originated from.&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "h7lyqq", "is_robot_indexable": true, "report_reasons": null, "author": "oystersauce8", "discussion_type": null, "num_comments": 8, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/h7lyqq/herokulogplex_error_l10_output_buffer_overflow/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/h7lyqq/herokulogplex_error_l10_output_buffer_overflow/", "subreddit_subscribers": 44489, "created_utc": 1591973068.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "I'm currently building a feature that requires me to loop over an hash, and for each key in the hash, dynamically modify an SQL query.\n\nThe actual SQL query should look something like this:\n\n```sql\nselect * from space_dates d\n\tinner join space_prices p on p.space_date_id = d.id\n\twhere d.space_id = ?\n\tand d.date between ? and ?\n\tand (\n\t\t(p.price_type = 'monthly' and p.price_cents &lt;&gt; 9360) or\n\t\t(p.price_type = 'daily' and p.price_cents &lt;&gt; 66198) or\n\t\t(p.price_type = 'hourly' and p.price_cents &lt;&gt; 66198) # This part should be added in dynamically\n\t)\n```\n\nThe last `and` query is to be added dynamically, as you can see, I basically need only one of the conditions to be true but not all.\n\n```\nquery = space.dates\n      .joins(:price)\n      .where('date between ? and ?', start_date, end_date)\n\n# We are looping over the rails enum (hash) and getting the key for each key value pair, alongside the index\n\nSpacePrice.price_types.each_with_index do |(price_type, _), index|\n  amount_cents = space.send(\"#{price_type}_price\").price_cents\n  query = if index.positive? # It's not the first item so we want to chain it as an 'OR'\n            query.or(\n              space.dates\n               .joins(:price)\n               .where('space_prices.price_type = ?', price_type)\n               .where('space_prices.price_cents &lt;&gt; ?', amount_cents)\n             )\n           else\n             query # It's the first item, chain it as an and\n               .where('space_prices.price_type = ?', price_type)\n               .where('space_prices.price_cents &lt;&gt; ?', amount_cents)\n           end\nend\n```\n\nThe output of this in rails is:\n\n```\nSELECT \"space_dates\".* FROM \"space_dates\"\n  INNER JOIN \"space_prices\" ON \"space_prices\".\"space_date_id\" = \"space_dates\".\"id\"\n  WHERE \"space_dates\".\"space_id\" = $1 AND (\n   (\n     (date between '2020-06-11' and '2020-06-11') AND\n     (space_prices.price_type = 'hourly') AND (space_prices.price_cents &lt;&gt; 9360) OR\n     (space_prices.price_type = 'daily') AND (space_prices.price_cents &lt;&gt; 66198)) OR\n     (space_prices.price_type = 'monthly') AND (space_prices.price_cents &lt;&gt; 5500)\n   ) LIMIT $2 \n```\n\nWhich isn't as expected. I need to wrap the last few lines in another set of round brackets in order to produce the same output. I'm not sure how to go about this using ActiveRecord.\n\nIt's not possible for me to use `find_by_sql` since this would be dynamically generated SQL too.", "author_fullname": "t2_ihkrk", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "How to handle dynamic, nested WHERE AND/OR queries using active record", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "top_awarded_type": null, "hide_score": false, "name": "t3_h7pxmb", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 1.0, "author_flair_background_color": null, "subreddit_type": "public", "ups": 3, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 3, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1592014324.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;I&amp;#39;m currently building a feature that requires me to loop over an hash, and for each key in the hash, dynamically modify an SQL query.&lt;/p&gt;\n\n&lt;p&gt;The actual SQL query should look something like this:&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;sql\nselect * from space_dates d\n    inner join space_prices p on p.space_date_id = d.id\n    where d.space_id = ?\n    and d.date between ? and ?\n    and (\n        (p.price_type = &amp;#39;monthly&amp;#39; and p.price_cents &amp;lt;&amp;gt; 9360) or\n        (p.price_type = &amp;#39;daily&amp;#39; and p.price_cents &amp;lt;&amp;gt; 66198) or\n        (p.price_type = &amp;#39;hourly&amp;#39; and p.price_cents &amp;lt;&amp;gt; 66198) # This part should be added in dynamically\n    )\n&lt;/code&gt;&lt;/p&gt;\n\n&lt;p&gt;The last &lt;code&gt;and&lt;/code&gt; query is to be added dynamically, as you can see, I basically need only one of the conditions to be true but not all.&lt;/p&gt;\n\n&lt;p&gt;```\nquery = space.dates\n      .joins(:price)\n      .where(&amp;#39;date between ? and ?&amp;#39;, start_date, end_date)&lt;/p&gt;\n\n&lt;h1&gt;We are looping over the rails enum (hash) and getting the key for each key value pair, alongside the index&lt;/h1&gt;\n\n&lt;p&gt;SpacePrice.price_types.each_with_index do |(price_type, _), index|\n  amount_cents = space.send(&amp;quot;#{price_type}_price&amp;quot;).price_cents\n  query = if index.positive? # It&amp;#39;s not the first item so we want to chain it as an &amp;#39;OR&amp;#39;\n            query.or(\n              space.dates\n               .joins(:price)\n               .where(&amp;#39;space_prices.price_type = ?&amp;#39;, price_type)\n               .where(&amp;#39;space_prices.price_cents &amp;lt;&amp;gt; ?&amp;#39;, amount_cents)\n             )\n           else\n             query # It&amp;#39;s the first item, chain it as an and\n               .where(&amp;#39;space_prices.price_type = ?&amp;#39;, price_type)\n               .where(&amp;#39;space_prices.price_cents &amp;lt;&amp;gt; ?&amp;#39;, amount_cents)\n           end\nend\n```&lt;/p&gt;\n\n&lt;p&gt;The output of this in rails is:&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;\nSELECT &amp;quot;space_dates&amp;quot;.* FROM &amp;quot;space_dates&amp;quot;\n  INNER JOIN &amp;quot;space_prices&amp;quot; ON &amp;quot;space_prices&amp;quot;.&amp;quot;space_date_id&amp;quot; = &amp;quot;space_dates&amp;quot;.&amp;quot;id&amp;quot;\n  WHERE &amp;quot;space_dates&amp;quot;.&amp;quot;space_id&amp;quot; = $1 AND (\n   (\n     (date between &amp;#39;2020-06-11&amp;#39; and &amp;#39;2020-06-11&amp;#39;) AND\n     (space_prices.price_type = &amp;#39;hourly&amp;#39;) AND (space_prices.price_cents &amp;lt;&amp;gt; 9360) OR\n     (space_prices.price_type = &amp;#39;daily&amp;#39;) AND (space_prices.price_cents &amp;lt;&amp;gt; 66198)) OR\n     (space_prices.price_type = &amp;#39;monthly&amp;#39;) AND (space_prices.price_cents &amp;lt;&amp;gt; 5500)\n   ) LIMIT $2 \n&lt;/code&gt;&lt;/p&gt;\n\n&lt;p&gt;Which isn&amp;#39;t as expected. I need to wrap the last few lines in another set of round brackets in order to produce the same output. I&amp;#39;m not sure how to go about this using ActiveRecord.&lt;/p&gt;\n\n&lt;p&gt;It&amp;#39;s not possible for me to use &lt;code&gt;find_by_sql&lt;/code&gt; since this would be dynamically generated SQL too.&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "h7pxmb", "is_robot_indexable": true, "report_reasons": null, "author": "jesster2k10", "discussion_type": null, "num_comments": 3, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/h7pxmb/how_to_handle_dynamic_nested_where_andor_queries/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/h7pxmb/how_to_handle_dynamic_nested_where_andor_queries/", "subreddit_subscribers": 44489, "created_utc": 1591985524.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "So I am using partial in new and edit part of my User object, and by default, Rails applies \\_method as PATCH while submitting the edit option. How can I use PUT instead of the patch.  \nI cant add method as then it will be an issue while creating a new user.", "author_fullname": "t2_59eg6hse", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Form_for PUT instead of PATCH in the edit form", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "top_awarded_type": null, "hide_score": false, "name": "t3_h7qr9d", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.75, "author_flair_background_color": null, "subreddit_type": "public", "ups": 2, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 2, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1592016957.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;So I am using partial in new and edit part of my User object, and by default, Rails applies _method as PATCH while submitting the edit option. How can I use PUT instead of the patch.&lt;br/&gt;\nI cant add method as then it will be an issue while creating a new user.&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "h7qr9d", "is_robot_indexable": true, "report_reasons": null, "author": "Stoned_Yet_Sober", "discussion_type": null, "num_comments": 1, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/h7qr9d/form_for_put_instead_of_patch_in_the_edit_form/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/h7qr9d/form_for_put_instead_of_patch_in_the_edit_form/", "subreddit_subscribers": 44489, "created_utc": 1591988157.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "When you have your project services (API backend, frontend, background processing, etc.) in one monorepo you might struggle with a simple way of deploying them to Heroku independently. Here's an article containing a way of doing just that.\n\nTL;DR: The easiest solution is \n```\ngit subtree push --prefix path/to/app-subdir heroku master\n```\n\nTo get more details and a more complex solution that provides the ability to set up a deployment from CI and utilizing Heroku Review Apps you can read the article.\n\nhttps://jtway.co/deploying-subdirectory-projects-to-heroku-f31ed65f3f2", "author_fullname": "t2_8ssqxy", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Deploying subdirectory projects to Heroku", "link_flair_richtext": [{"e": "text", "t": "Tutorial"}], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": "tutorial", "downs": 0, "top_awarded_type": null, "hide_score": false, "name": "t3_h7iazy", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.91, "author_flair_background_color": null, "subreddit_type": "public", "ups": 8, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": "Tutorial", "can_mod_post": false, "score": 8, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1591986840.0, "link_flair_type": "richtext", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;When you have your project services (API backend, frontend, background processing, etc.) in one monorepo you might struggle with a simple way of deploying them to Heroku independently. Here&amp;#39;s an article containing a way of doing just that.&lt;/p&gt;\n\n&lt;p&gt;TL;DR: The easiest solution is \n&lt;code&gt;\ngit subtree push --prefix path/to/app-subdir heroku master\n&lt;/code&gt;&lt;/p&gt;\n\n&lt;p&gt;To get more details and a more complex solution that provides the ability to set up a deployment from CI and utilizing Heroku Review Apps you can read the article.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://jtway.co/deploying-subdirectory-projects-to-heroku-f31ed65f3f2\"&gt;https://jtway.co/deploying-subdirectory-projects-to-heroku-f31ed65f3f2&lt;/a&gt;&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "link_flair_template_id": "2a348462-af75-11e4-abe9-22000b3d0989", "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "h7iazy", "is_robot_indexable": true, "report_reasons": null, "author": "jetthoughts", "discussion_type": null, "num_comments": 4, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/h7iazy/deploying_subdirectory_projects_to_heroku/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/h7iazy/deploying_subdirectory_projects_to_heroku/", "subreddit_subscribers": 44489, "created_utc": 1591958040.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "**So this has always been a debatable topic.**  \n**Approach 1:** We use the classic rails MVC architecture with Server Side rendering.  \n**Approach 2:** We use client-side rendering, with rails working as a backend providing the JSON response and client to be made using react or any frontend framework.\n\n  \nI would love to get some insights and have a discussion on what are the pros and cons of both these approaches.  \n\n\nSome of my thoughts are:  \n\\* Using client-side rendering restricts us to leverage the magic provided by rails. (form auto completions, an automatic mapping between endpoint and controller methods)  \n\\* Client-side rendering makes the application a bit lighter, as the server is not responsible for rendering the UI for every instance.  \n\\* I personally am not very comfortable in Js, so using Rails MVC is always an easy way out for me.  \n\n\nLet's discuss this!", "author_fullname": "t2_59eg6hse", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "MVC vs 3-tier architecture", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "top_awarded_type": null, "hide_score": false, "name": "t3_h17sez", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.94, "author_flair_background_color": null, "subreddit_type": "public", "ups": 16, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 16, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1591937600.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;&lt;strong&gt;So this has always been a debatable topic.&lt;/strong&gt;&lt;br/&gt;\n&lt;strong&gt;Approach 1:&lt;/strong&gt; We use the classic rails MVC architecture with Server Side rendering.&lt;br/&gt;\n&lt;strong&gt;Approach 2:&lt;/strong&gt; We use client-side rendering, with rails working as a backend providing the JSON response and client to be made using react or any frontend framework.&lt;/p&gt;\n\n&lt;p&gt;I would love to get some insights and have a discussion on what are the pros and cons of both these approaches.  &lt;/p&gt;\n\n&lt;p&gt;Some of my thoughts are:&lt;br/&gt;\n* Using client-side rendering restricts us to leverage the magic provided by rails. (form auto completions, an automatic mapping between endpoint and controller methods)&lt;br/&gt;\n* Client-side rendering makes the application a bit lighter, as the server is not responsible for rendering the UI for every instance.&lt;br/&gt;\n* I personally am not very comfortable in Js, so using Rails MVC is always an easy way out for me.  &lt;/p&gt;\n\n&lt;p&gt;Let&amp;#39;s discuss this!&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "h17sez", "is_robot_indexable": true, "report_reasons": null, "author": "Stoned_Yet_Sober", "discussion_type": null, "num_comments": 22, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/h17sez/mvc_vs_3tier_architecture/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/h17sez/mvc_vs_3tier_architecture/", "subreddit_subscribers": 44489, "created_utc": 1591908800.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "I'm trying to render a partial/hide another partial on a page when a button is clicked. Is this possible with a conditional? Or possible at all? Something like:   \n\n\n    -if @toggle == 'show'\n      = render :partial =&gt; \"partial_one\"\n    \n    -elsif @toggle == 'hide'\n      = render :partial =&gt; \"partial_two\"", "author_fullname": "t2_4crzuo7f", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Can I use a conditional to toggle between rendered partials?", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "top_awarded_type": null, "hide_score": false, "name": "t3_h79ljs", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.88, "author_flair_background_color": null, "subreddit_type": "public", "ups": 6, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 6, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1591948240.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;I&amp;#39;m trying to render a partial/hide another partial on a page when a button is clicked. Is this possible with a conditional? Or possible at all? Something like:   &lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;-if @toggle == &amp;#39;show&amp;#39;\n  = render :partial =&amp;gt; &amp;quot;partial_one&amp;quot;\n\n-elsif @toggle == &amp;#39;hide&amp;#39;\n  = render :partial =&amp;gt; &amp;quot;partial_two&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": true, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "h79ljs", "is_robot_indexable": true, "report_reasons": null, "author": "santamariacode", "discussion_type": null, "num_comments": 9, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/h79ljs/can_i_use_a_conditional_to_toggle_between/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/h79ljs/can_i_use_a_conditional_to_toggle_between/", "subreddit_subscribers": 44489, "created_utc": 1591919440.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "As the title says, I am implementing search functionality on a social network project.\n\nI want it to feel snappy and provide good suggestions on typing and since I just came back to Rails after a long hiatus in javascript land, I'm not sure if Rails provides something for this out of the box or if should use something like Algolia which is a search-as-a-service to save me the headache.\n\nAny ideas/feeback are welcome!\n\n&amp;#x200B;\n\nRegards", "author_fullname": "t2_nt4f4", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Implementing search, should I go for Algolia or is Rails/Postgres enough?", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "top_awarded_type": null, "hide_score": false, "name": "t3_h14rpx", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 1.0, "author_flair_background_color": null, "subreddit_type": "public", "ups": 10, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 10, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1591928406.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;As the title says, I am implementing search functionality on a social network project.&lt;/p&gt;\n\n&lt;p&gt;I want it to feel snappy and provide good suggestions on typing and since I just came back to Rails after a long hiatus in javascript land, I&amp;#39;m not sure if Rails provides something for this out of the box or if should use something like Algolia which is a search-as-a-service to save me the headache.&lt;/p&gt;\n\n&lt;p&gt;Any ideas/feeback are welcome!&lt;/p&gt;\n\n&lt;p&gt;&amp;#x200B;&lt;/p&gt;\n\n&lt;p&gt;Regards&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "h14rpx", "is_robot_indexable": true, "report_reasons": null, "author": "Eunoia_R", "discussion_type": null, "num_comments": 15, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/h14rpx/implementing_search_should_i_go_for_algolia_or_is/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/h14rpx/implementing_search_should_i_go_for_algolia_or_is/", "subreddit_subscribers": 44489, "created_utc": 1591899606.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "I'm building a Rails API app that deals with orchestrating Users within a Company, and I want to check my logic for attaching Settings to a User.\n\nThe idea is, an admin at a Company will create a Settings entry in the database, and then assign that to a bunch of users.\n\n&amp;#x200B;\n\nBecause this is an API, I have one call to create a Setting, one call to create a User, and one call to assign a Setting to a User.\n\n&amp;#x200B;\n\nHere's what the User controller looks like:\n\n    class UsersController &lt; ApplicationController\n    \n      def set_setting\n        if @user.update(setting: Setting.find(params[:setting_id]))\n          render :show\n        else\n          render json: @user.errors, status: :unprocessable_entity\n        end\n      end\n    \n    end\n\nAnd here's how I'm doing the validation in the User model:\n\n    class User &lt; ApplicationRecord\n      belongs_to :organisation\n      has_one :user_setting\n      has_one :setting, through: :user_setting\n    \n      validate :setting_in_organisation, on: :update\n    \n      private\n    \n        def setting_in_organisation\n          errors.add(:setting_id, \"You can't assign a setting that's not part of your organisation\") unless setting.organisation == organisation\n        end\n    end\n\nSo, my question is, is this a good way to approach the issue while sticking to Rails ethos and DRY principals? I think it's important to highlight the views for this app are handled in a different repo. And because it's an API I definitely want a separate call to assign a Setting to a User, rather than chucking everything in user\\_params.\n\nWhat's everyone's thoughts?", "author_fullname": "t2_iqw7y", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Appropriate way to validate association", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "top_awarded_type": null, "hide_score": false, "name": "t3_h128cd", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 1.0, "author_flair_background_color": null, "subreddit_type": "public", "ups": 8, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 8, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1591920556.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;I&amp;#39;m building a Rails API app that deals with orchestrating Users within a Company, and I want to check my logic for attaching Settings to a User.&lt;/p&gt;\n\n&lt;p&gt;The idea is, an admin at a Company will create a Settings entry in the database, and then assign that to a bunch of users.&lt;/p&gt;\n\n&lt;p&gt;&amp;#x200B;&lt;/p&gt;\n\n&lt;p&gt;Because this is an API, I have one call to create a Setting, one call to create a User, and one call to assign a Setting to a User.&lt;/p&gt;\n\n&lt;p&gt;&amp;#x200B;&lt;/p&gt;\n\n&lt;p&gt;Here&amp;#39;s what the User controller looks like:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;class UsersController &amp;lt; ApplicationController\n\n  def set_setting\n    if @user.update(setting: Setting.find(params[:setting_id]))\n      render :show\n    else\n      render json: @user.errors, status: :unprocessable_entity\n    end\n  end\n\nend\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;And here&amp;#39;s how I&amp;#39;m doing the validation in the User model:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;class User &amp;lt; ApplicationRecord\n  belongs_to :organisation\n  has_one :user_setting\n  has_one :setting, through: :user_setting\n\n  validate :setting_in_organisation, on: :update\n\n  private\n\n    def setting_in_organisation\n      errors.add(:setting_id, &amp;quot;You can&amp;#39;t assign a setting that&amp;#39;s not part of your organisation&amp;quot;) unless setting.organisation == organisation\n    end\nend\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;So, my question is, is this a good way to approach the issue while sticking to Rails ethos and DRY principals? I think it&amp;#39;s important to highlight the views for this app are handled in a different repo. And because it&amp;#39;s an API I definitely want a separate call to assign a Setting to a User, rather than chucking everything in user_params.&lt;/p&gt;\n\n&lt;p&gt;What&amp;#39;s everyone&amp;#39;s thoughts?&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "h128cd", "is_robot_indexable": true, "report_reasons": null, "author": "alexpapworth", "discussion_type": null, "num_comments": 1, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/h128cd/appropriate_way_to_validate_association/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/h128cd/appropriate_way_to_validate_association/", "subreddit_subscribers": 44489, "created_utc": 1591891756.0, "num_crossposts": 0, "media": null, "is_video": false}}], "after": "t3_h128cd", "before": null}}