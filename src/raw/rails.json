{"kind": "Listing", "data": {"modhash": "", "dist": 11, "children": [{"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "In this thread you can showcase your personal pet project to other redditors.\n\nNeed help with a specific problem or just wanna have some extra eyeballs on your code? Ask away!\n\nA suggested format to get you started:\n\n1. **Name of your project**\n2. **A short description**\n3. **Application stack**\n4. **Link to Live app**\n5. **Link to GitHub**\n6. **You experience level**\n7. **Other information or areas that you would like advice on**\n\n\u00a0\n\n^(Many thanks to Kritnc for getting the ball rolling.)", "author_fullname": "t2_6l4z3", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Personal Projects - Show off your own project and/or ask for advice", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "hide_score": false, "name": "t3_gek2rk", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 1.0, "author_flair_background_color": null, "subreddit_type": "public", "ups": 18, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 18, "approved_by": null, "author_premium": true, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1588800767.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;In this thread you can showcase your personal pet project to other redditors.&lt;/p&gt;\n\n&lt;p&gt;Need help with a specific problem or just wanna have some extra eyeballs on your code? Ask away!&lt;/p&gt;\n\n&lt;p&gt;A suggested format to get you started:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;Name of your project&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;A short description&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Application stack&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Link to Live app&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Link to GitHub&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;You experience level&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Other information or areas that you would like advice on&lt;/strong&gt;&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;\u00a0&lt;/p&gt;\n\n&lt;p&gt;&lt;sup&gt;Many thanks to Kritnc for getting the ball rolling.&lt;/sup&gt;&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": true, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": "moderator", "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "gek2rk", "is_robot_indexable": true, "report_reasons": null, "author": "AutoModerator", "discussion_type": null, "num_comments": 16, "send_replies": false, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/gek2rk/personal_projects_show_off_your_own_project_andor/", "parent_whitelist_status": "all_ads", "stickied": true, "url": "https://www.reddit.com/r/rails/comments/gek2rk/personal_projects_show_off_your_own_project_andor/", "subreddit_subscribers": 43988, "created_utc": 1588771967.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "Hi guys\n\nI'm trying to set up social login for my react native app which has a rails backend.\n\nI've read a lot of tutorials but most of them focus on rails as a web app solution, not so much as an api. For example, I think I might be needing the omniauth gem but I'm not sure if I also need devise when I'm not making use of most of its features (views, controllers, ...) and when I'm just issuing JWT's.  \n\n\nSo I'm not sure what else I need or how best to approach this.\n\nI was also contemplating using something like auth0 if using something like omniauth is not secure/scalable enough.\n\n&amp;#x200B;\n\nAny thoughts or help would be greatly appreciated!  \nStay safe!", "author_fullname": "t2_nt4f4", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "How to handle social login from a react native app to rails api", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "hide_score": false, "name": "t3_givaz1", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 1.0, "author_flair_background_color": null, "subreddit_type": "public", "ups": 9, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 9, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1589388831.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;Hi guys&lt;/p&gt;\n\n&lt;p&gt;I&amp;#39;m trying to set up social login for my react native app which has a rails backend.&lt;/p&gt;\n\n&lt;p&gt;I&amp;#39;ve read a lot of tutorials but most of them focus on rails as a web app solution, not so much as an api. For example, I think I might be needing the omniauth gem but I&amp;#39;m not sure if I also need devise when I&amp;#39;m not making use of most of its features (views, controllers, ...) and when I&amp;#39;m just issuing JWT&amp;#39;s.  &lt;/p&gt;\n\n&lt;p&gt;So I&amp;#39;m not sure what else I need or how best to approach this.&lt;/p&gt;\n\n&lt;p&gt;I was also contemplating using something like auth0 if using something like omniauth is not secure/scalable enough.&lt;/p&gt;\n\n&lt;p&gt;&amp;#x200B;&lt;/p&gt;\n\n&lt;p&gt;Any thoughts or help would be greatly appreciated!&lt;br/&gt;\nStay safe!&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": true, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "givaz1", "is_robot_indexable": true, "report_reasons": null, "author": "Eunoia_R", "discussion_type": null, "num_comments": 5, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/givaz1/how_to_handle_social_login_from_a_react_native/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/givaz1/how_to_handle_social_login_from_a_react_native/", "subreddit_subscribers": 43988, "created_utc": 1589360031.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "I have Document table having a column of file:binary status:integer and expiration\\_date:datetime.   \nDocument.create(file: Rack::Test::UploadedFile.new(\"#{Rails.root}/spec/fixtures/files/testing\\_file\\_#{rand(100)}.csv\", 'application/csv'), status: 0, expiration\\_date= \"2020-05-13 16:48:21\")  \nAfter that, when i want to see the record the file is nil and the rest column has a record.", "author_fullname": "t2_6bi4zbai", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "How to create file(output.pdf) to table database in rails console?", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "hide_score": false, "name": "t3_givqm5", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 1.0, "author_flair_background_color": null, "subreddit_type": "public", "ups": 3, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 3, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1589391027.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;I have Document table having a column of file:binary status:integer and expiration_date:datetime.&lt;br/&gt;\nDocument.create(file: Rack::Test::UploadedFile.new(&amp;quot;#{Rails.root}/spec/fixtures/files/testing_file_#{rand(100)}.csv&amp;quot;, &amp;#39;application/csv&amp;#39;), status: 0, expiration_date= &amp;quot;2020-05-13 16:48:21&amp;quot;)&lt;br/&gt;\nAfter that, when i want to see the record the file is nil and the rest column has a record.&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "givqm5", "is_robot_indexable": true, "report_reasons": null, "author": "sosopine", "discussion_type": null, "num_comments": 1, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/givqm5/how_to_create_fileoutputpdf_to_table_database_in/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/givqm5/how_to_create_fileoutputpdf_to_table_database_in/", "subreddit_subscribers": 43988, "created_utc": 1589362227.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "I have a Rails 6 project that uses webpacker to manage its assets which I'm trying to deploy in a VPS w/ nginx + passenger as my application server. However, the css assets won't seem to display properly. JS files seem to be working ok.\n\nWhat I tried to do:\n\n```\n\n$ RAILS_ENV=production bundle exec rails assets:precompile\n\n$ RAILS_ENV=production RACK_ENV=production NODE_ENV=production ./bin/webpack\n\n```\n\nWhy won't my css load correctly?", "author_fullname": "t2_x6pudoo", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Deploying Rails 6 w/ Webpacker to Nginx VPS", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "hide_score": false, "name": "t3_gitcbu", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 1.0, "author_flair_background_color": null, "subreddit_type": "public", "ups": 4, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 4, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1589379362.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;I have a Rails 6 project that uses webpacker to manage its assets which I&amp;#39;m trying to deploy in a VPS w/ nginx + passenger as my application server. However, the css assets won&amp;#39;t seem to display properly. JS files seem to be working ok.&lt;/p&gt;\n\n&lt;p&gt;What I tried to do:&lt;/p&gt;\n\n&lt;p&gt;```&lt;/p&gt;\n\n&lt;p&gt;$ RAILS_ENV=production bundle exec rails assets:precompile&lt;/p&gt;\n\n&lt;p&gt;$ RAILS_ENV=production RACK_ENV=production NODE_ENV=production ./bin/webpack&lt;/p&gt;\n\n&lt;p&gt;```&lt;/p&gt;\n\n&lt;p&gt;Why won&amp;#39;t my css load correctly?&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "gitcbu", "is_robot_indexable": true, "report_reasons": null, "author": "ralampay", "discussion_type": null, "num_comments": 7, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/gitcbu/deploying_rails_6_w_webpacker_to_nginx_vps/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/gitcbu/deploying_rails_6_w_webpacker_to_nginx_vps/", "subreddit_subscribers": 43988, "created_utc": 1589350562.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "If you are familiar with the `db:migrate:redo` rake task you've probably noticed how it's convenient for fixing one migration, usually that's latest one.\n\nIf run without params, at first the task rolls back the latest applied migration, i.e. runs `down` , and then immediately migrates it, i.e. runs `up`. Now, guess what happens if `up` step fails? Right, the `down` step remains performed, what means the latest applied migration now is not the one was a moment ago but the previous one. Next `db:migrate:redo` run, usually after the latest migration fix, surprisingly tries to run the previous migration. That's something unexpected, drives made, and makes the task useless in the scenario when a migration is being fixed that usually requires numerous of changes and `redo`'ing it several times.\n\nI promote a [fix](https://github.com/rails/rails/pull/39026) for that problem. That wraps entire `db:migrate:redo` task into a transaction. It won't change current migration to the previous one when `down` step fails as in the scenario above. That makes fixing a certain migration with more comfort since redo task is idempotent and can run as many times as needed.\n\nThis post aims to gather feedback on the specified problem and the [pull request](https://github.com/rails/rails/pull/39026).\n\nAll participants, thank you for your attention!", "author_fullname": "t2_d7ta3", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Transacted db:migrate:redo rake task", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "hide_score": false, "name": "t3_givoeb", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 1.0, "author_flair_background_color": null, "subreddit_type": "public", "ups": 2, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 2, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1589390716.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;If you are familiar with the &lt;code&gt;db:migrate:redo&lt;/code&gt; rake task you&amp;#39;ve probably noticed how it&amp;#39;s convenient for fixing one migration, usually that&amp;#39;s latest one.&lt;/p&gt;\n\n&lt;p&gt;If run without params, at first the task rolls back the latest applied migration, i.e. runs &lt;code&gt;down&lt;/code&gt; , and then immediately migrates it, i.e. runs &lt;code&gt;up&lt;/code&gt;. Now, guess what happens if &lt;code&gt;up&lt;/code&gt; step fails? Right, the &lt;code&gt;down&lt;/code&gt; step remains performed, what means the latest applied migration now is not the one was a moment ago but the previous one. Next &lt;code&gt;db:migrate:redo&lt;/code&gt; run, usually after the latest migration fix, surprisingly tries to run the previous migration. That&amp;#39;s something unexpected, drives made, and makes the task useless in the scenario when a migration is being fixed that usually requires numerous of changes and &lt;code&gt;redo&lt;/code&gt;&amp;#39;ing it several times.&lt;/p&gt;\n\n&lt;p&gt;I promote a &lt;a href=\"https://github.com/rails/rails/pull/39026\"&gt;fix&lt;/a&gt; for that problem. That wraps entire &lt;code&gt;db:migrate:redo&lt;/code&gt; task into a transaction. It won&amp;#39;t change current migration to the previous one when &lt;code&gt;down&lt;/code&gt; step fails as in the scenario above. That makes fixing a certain migration with more comfort since redo task is idempotent and can run as many times as needed.&lt;/p&gt;\n\n&lt;p&gt;This post aims to gather feedback on the specified problem and the &lt;a href=\"https://github.com/rails/rails/pull/39026\"&gt;pull request&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;All participants, thank you for your attention!&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "givoeb", "is_robot_indexable": true, "report_reasons": null, "author": "ka8725", "discussion_type": null, "num_comments": 0, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/givoeb/transacted_dbmigrateredo_rake_task/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/givoeb/transacted_dbmigrateredo_rake_task/", "subreddit_subscribers": 43988, "created_utc": 1589361916.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "How do I go about building a coding challenge site like freecodecamp. I know how to embed code editors using code mirror or ace.c9. But these editors don\u2019t compile the code and I also don\u2019t know how to add the \u201crun the tests\u201d button.\n\nWhere can I learn to implement a site like this (preferably using ruby on rails)? Is there anything I need to learn or is there any API or ruby gem I can use?", "author_fullname": "t2_48eql2pd", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "How do sites like Freecodecamp work?", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "hide_score": true, "name": "t3_gixx9u", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 1.0, "author_flair_background_color": null, "subreddit_type": "public", "ups": 1, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 1, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1589401144.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;How do I go about building a coding challenge site like freecodecamp. I know how to embed code editors using code mirror or ace.c9. But these editors don\u2019t compile the code and I also don\u2019t know how to add the \u201crun the tests\u201d button.&lt;/p&gt;\n\n&lt;p&gt;Where can I learn to implement a site like this (preferably using ruby on rails)? Is there anything I need to learn or is there any API or ruby gem I can use?&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": true, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "gixx9u", "is_robot_indexable": true, "report_reasons": null, "author": "Sorrythisispatrick", "discussion_type": null, "num_comments": 0, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/gixx9u/how_do_sites_like_freecodecamp_work/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/gixx9u/how_do_sites_like_freecodecamp_work/", "subreddit_subscribers": 43988, "created_utc": 1589372344.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "I was wondering if anyone has any useful rake tasks they would like to share. Here are a few I find useful.\n\nCheck Database connection\n\n    namespace :db  do\n      desc \"Test if you can connect to the database\"\n      task :test =&gt; :environment do\n        begin\n          ActiveRecord::Base.establish_connection # Establishes connection\n          ActiveRecord::Base.connection # Calls connection object\n          puts \"CONNECTED!\" if ActiveRecord::Base.connected?\n          puts \"NOT CONNECTED!\" unless ActiveRecord::Base.connected?\n        rescue\n          puts \"NOT CONNECTED!\"\n        end\n      end\n    end\n\nDelete All Tables\n\n    namespace :db do\n      desc \"Erase all tables\"\n      task :erase =&gt; :environment do\n        conn = ActiveRecord::Base.connection\n        tables = conn.tables\n        tables.each do |table|\n    \n          puts \"Deleting #{table}\"\n    \n          # Disable key checks\n          if conn.instance_of?(ActiveRecord::ConnectionAdapters::Mysql2Adapter)\n            conn.execute(\"SET FOREIGN_KEY_CHECKS = 0;\")\n          else\n            conn.execute(\"ALTER TABLE #{table} DISABLE TRIGGER ALL;\")\n          end\n    \n          conn.drop_table(table, force: :cascade)\n    \n          # Enable key checks\n          if conn.instance_of?(ActiveRecord::ConnectionAdapters::Mysql2Adapter)\n            conn.execute(\"SET FOREIGN_KEY_CHECKS = 1;\")\n          else\n            conn.execute(\"ALTER TABLE #{table} ENABLE TRIGGER ALL;\")\n          end\n        end\n    \n      end\n    end\n\nQuick Rebuild of Database\n\n    namespace :db  do\n      desc \"Rebuild the data in the databae\"\n      task :rebuild =&gt; :environment do\n        puts \"-- Rebuild the Database --\"\n    \n        puts \"- Dropping Database\"\n        Rake::Task[\"db:drop\"].invoke\n    \n        puts \"- Creating Tables\"\n        Rake::Task[\"db:create\"].invoke\n    \n        puts \"- Migrating\"\n        Rake::Task[\"db:migrate\"].invoke\n    \n        puts \"- Seeding\"\n        Rake::Task[\"db:seed\"].invoke\n    \n        puts \"- Finish\"\n      end\n    end\n\nTruncate All Tables\n\n    namespace :db do\n      desc \"Truncate all tables\"\n      task :truncate_all =&gt; :environment do\n        conn = ActiveRecord::Base.connection\n        tables = conn.tables\n        tables.each do |table|\n          unless [\"schema_migrations\", \"ar_internal_metadata\"].include?(table)\n            puts \"Truncating #{table}\"\n    \n            # Disable key checks\n            if conn.instance_of?(ActiveRecord::ConnectionAdapters::Mysql2Adapter)\n              conn.execute(\"SET FOREIGN_KEY_CHECKS = 0;\")\n            else\n              conn.execute(\"ALTER TABLE #{table} DISABLE TRIGGER ALL;\")\n            end\n    \n            conn.execute(\"TRUNCATE #{table}\")\n            #conn.drop_table(table, force: :cascade)\n    \n            # Enable key checks\n            if conn.instance_of?(ActiveRecord::ConnectionAdapters::Mysql2Adapter)\n              conn.execute(\"SET FOREIGN_KEY_CHECKS = 1;\")\n            else\n              conn.execute(\"ALTER TABLE #{table} ENABLE TRIGGER ALL;\")\n            end\n          end\n        end\n    \n      end\n    end\n\nI am still fairly new to rake so let me know if any of these can be improved upon", "author_fullname": "t2_4govoigp", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Useful Rake Tasks - Submit yours :-)", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "hide_score": false, "name": "t3_gissru", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.75, "author_flair_background_color": null, "subreddit_type": "public", "ups": 2, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 2, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1589376831.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;I was wondering if anyone has any useful rake tasks they would like to share. Here are a few I find useful.&lt;/p&gt;\n\n&lt;p&gt;Check Database connection&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;namespace :db  do\n  desc &amp;quot;Test if you can connect to the database&amp;quot;\n  task :test =&amp;gt; :environment do\n    begin\n      ActiveRecord::Base.establish_connection # Establishes connection\n      ActiveRecord::Base.connection # Calls connection object\n      puts &amp;quot;CONNECTED!&amp;quot; if ActiveRecord::Base.connected?\n      puts &amp;quot;NOT CONNECTED!&amp;quot; unless ActiveRecord::Base.connected?\n    rescue\n      puts &amp;quot;NOT CONNECTED!&amp;quot;\n    end\n  end\nend\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Delete All Tables&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;namespace :db do\n  desc &amp;quot;Erase all tables&amp;quot;\n  task :erase =&amp;gt; :environment do\n    conn = ActiveRecord::Base.connection\n    tables = conn.tables\n    tables.each do |table|\n\n      puts &amp;quot;Deleting #{table}&amp;quot;\n\n      # Disable key checks\n      if conn.instance_of?(ActiveRecord::ConnectionAdapters::Mysql2Adapter)\n        conn.execute(&amp;quot;SET FOREIGN_KEY_CHECKS = 0;&amp;quot;)\n      else\n        conn.execute(&amp;quot;ALTER TABLE #{table} DISABLE TRIGGER ALL;&amp;quot;)\n      end\n\n      conn.drop_table(table, force: :cascade)\n\n      # Enable key checks\n      if conn.instance_of?(ActiveRecord::ConnectionAdapters::Mysql2Adapter)\n        conn.execute(&amp;quot;SET FOREIGN_KEY_CHECKS = 1;&amp;quot;)\n      else\n        conn.execute(&amp;quot;ALTER TABLE #{table} ENABLE TRIGGER ALL;&amp;quot;)\n      end\n    end\n\n  end\nend\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Quick Rebuild of Database&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;namespace :db  do\n  desc &amp;quot;Rebuild the data in the databae&amp;quot;\n  task :rebuild =&amp;gt; :environment do\n    puts &amp;quot;-- Rebuild the Database --&amp;quot;\n\n    puts &amp;quot;- Dropping Database&amp;quot;\n    Rake::Task[&amp;quot;db:drop&amp;quot;].invoke\n\n    puts &amp;quot;- Creating Tables&amp;quot;\n    Rake::Task[&amp;quot;db:create&amp;quot;].invoke\n\n    puts &amp;quot;- Migrating&amp;quot;\n    Rake::Task[&amp;quot;db:migrate&amp;quot;].invoke\n\n    puts &amp;quot;- Seeding&amp;quot;\n    Rake::Task[&amp;quot;db:seed&amp;quot;].invoke\n\n    puts &amp;quot;- Finish&amp;quot;\n  end\nend\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Truncate All Tables&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;namespace :db do\n  desc &amp;quot;Truncate all tables&amp;quot;\n  task :truncate_all =&amp;gt; :environment do\n    conn = ActiveRecord::Base.connection\n    tables = conn.tables\n    tables.each do |table|\n      unless [&amp;quot;schema_migrations&amp;quot;, &amp;quot;ar_internal_metadata&amp;quot;].include?(table)\n        puts &amp;quot;Truncating #{table}&amp;quot;\n\n        # Disable key checks\n        if conn.instance_of?(ActiveRecord::ConnectionAdapters::Mysql2Adapter)\n          conn.execute(&amp;quot;SET FOREIGN_KEY_CHECKS = 0;&amp;quot;)\n        else\n          conn.execute(&amp;quot;ALTER TABLE #{table} DISABLE TRIGGER ALL;&amp;quot;)\n        end\n\n        conn.execute(&amp;quot;TRUNCATE #{table}&amp;quot;)\n        #conn.drop_table(table, force: :cascade)\n\n        # Enable key checks\n        if conn.instance_of?(ActiveRecord::ConnectionAdapters::Mysql2Adapter)\n          conn.execute(&amp;quot;SET FOREIGN_KEY_CHECKS = 1;&amp;quot;)\n        else\n          conn.execute(&amp;quot;ALTER TABLE #{table} ENABLE TRIGGER ALL;&amp;quot;)\n        end\n      end\n    end\n\n  end\nend\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;I am still fairly new to rake so let me know if any of these can be improved upon&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": true, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "gissru", "is_robot_indexable": true, "report_reasons": null, "author": "x9sim9", "discussion_type": null, "num_comments": 2, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/gissru/useful_rake_tasks_submit_yours/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/gissru/useful_rake_tasks_submit_yours/", "subreddit_subscribers": 43988, "created_utc": 1589348031.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "How do you implement background and cron job in RoR ? Do you use Sidekiq or Sneaker, Bunny via RabbitMQ ?\nI have read Sidekiq but to get all features we should paid for it :(, does Sidekiq free still Worth it ?\n\nHave anyone using RabbitMQ for this case here ? Not many people out there share the article for this in RoR \n\nOr do you use Whener gem for cronjob?", "author_fullname": "t2_13rsuo", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "What you use in RoR for background and cron job?", "link_flair_richtext": [{"e": "text", "t": "Question"}], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": "question", "downs": 0, "hide_score": false, "name": "t3_gikvol", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.91, "author_flair_background_color": null, "subreddit_type": "public", "ups": 9, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": "Question", "can_mod_post": false, "score": 9, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1589347815.0, "link_flair_type": "richtext", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;How do you implement background and cron job in RoR ? Do you use Sidekiq or Sneaker, Bunny via RabbitMQ ?\nI have read Sidekiq but to get all features we should paid for it :(, does Sidekiq free still Worth it ?&lt;/p&gt;\n\n&lt;p&gt;Have anyone using RabbitMQ for this case here ? Not many people out there share the article for this in RoR &lt;/p&gt;\n\n&lt;p&gt;Or do you use Whener gem for cronjob?&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": true, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "link_flair_template_id": "fdfc6806-aea7-11e4-bf37-22000b3889f5", "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "gikvol", "is_robot_indexable": true, "report_reasons": null, "author": "Hoollick", "discussion_type": null, "num_comments": 47, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/gikvol/what_you_use_in_ror_for_background_and_cron_job/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/gikvol/what_you_use_in_ror_for_background_and_cron_job/", "subreddit_subscribers": 43988, "created_utc": 1589319015.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "Hi,\n\nI'm really new to programming and even more so to Ruby. \n\nI don't know what has happened or what i clicked, but recently my RubyMine IDE stopped highlighting (whitening) variables once I have used them in my code. For example a placeholder in an .each function would previously go from grey to white once I used it; now it does nothing.\n\nIn addition, whenever there were errors in the console I could double click and it would take me right there...saving me time and effort.  This functionality has suddenly stopped being available and now I have to go to the line of code manually.\n\nI was wondering what I may have done and how I can remedy this? I know it's a long shot but I would absolutely be appreciative of any assistance.", "author_fullname": "t2_9yuk1", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "RubyMine IDE \"Errors\"...this is a long shot. (Double click in console not leading to error, variables no longer changing colour from grey to white when used in code etc)", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "hide_score": false, "name": "t3_gim432", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 1.0, "author_flair_background_color": null, "subreddit_type": "public", "ups": 6, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 6, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1589351803.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": true, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;Hi,&lt;/p&gt;\n\n&lt;p&gt;I&amp;#39;m really new to programming and even more so to Ruby. &lt;/p&gt;\n\n&lt;p&gt;I don&amp;#39;t know what has happened or what i clicked, but recently my RubyMine IDE stopped highlighting (whitening) variables once I have used them in my code. For example a placeholder in an .each function would previously go from grey to white once I used it; now it does nothing.&lt;/p&gt;\n\n&lt;p&gt;In addition, whenever there were errors in the console I could double click and it would take me right there...saving me time and effort.  This functionality has suddenly stopped being available and now I have to go to the line of code manually.&lt;/p&gt;\n\n&lt;p&gt;I was wondering what I may have done and how I can remedy this? I know it&amp;#39;s a long shot but I would absolutely be appreciative of any assistance.&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": true, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "gim432", "is_robot_indexable": true, "report_reasons": null, "author": "HeavensWrath", "discussion_type": null, "num_comments": 11, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/gim432/rubymine_ide_errorsthis_is_a_long_shot_double/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/gim432/rubymine_ide_errorsthis_is_a_long_shot_double/", "subreddit_subscribers": 43988, "created_utc": 1589323003.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "Do i need to rails migration or edit my migration after i generate a model?", "author_fullname": "t2_6bi4zbai", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "How to have auto increment of uuid or default id", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "hide_score": false, "name": "t3_gipsf4", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.75, "author_flair_background_color": null, "subreddit_type": "public", "ups": 2, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 2, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1589364640.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;Do i need to rails migration or edit my migration after i generate a model?&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "gipsf4", "is_robot_indexable": true, "report_reasons": null, "author": "sosopine", "discussion_type": null, "num_comments": 1, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/gipsf4/how_to_have_auto_increment_of_uuid_or_default_id/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/gipsf4/how_to_have_auto_increment_of_uuid_or_default_id/", "subreddit_subscribers": 43988, "created_utc": 1589335840.0, "num_crossposts": 0, "media": null, "is_video": false}}, {"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "rails", "selftext": "Hi all, \n\nI'm currently running the following script against 2 million database rows in order to move the associated S3 resources to Deep Archive.\n\nHowever, this process is causing our Kubernetes pods to crash and restart over and over, probably because I'm processing so much data in and out. \n\nLook at the job pods failing:\n```\njobs-954db9b68-6qd5n                 1/1     Running     47         4d5h\njobs-954db9b68-9cmsf                 1/1     Running     249        2d14h\njobs-954db9b68-hz7jr                 1/1     Running     18         9h\njobs-954db9b68-kw8jd                 1/1     Running     182        2d14h\njobs-954db9b68-kw8vs                 1/1     Running     13         7h1m\njobs-954db9b68-mjnvs                 1/1     Running     3          7h1m\njobs-954db9b68-qwbw8                 1/1     Running     61         20h\njobs-954db9b68-sgmq2                 1/1     Running     11         14h\njobs-954db9b68-tx5nr                 1/1     Running     22         9h\njobs-954db9b68-vzcss                 1/1     Running     23         9h\njobs-954db9b68-w879w                 1/1     Running     22         20h\njobs-954db9b68-x9nc5                 1/1     Running     20         9h\n\n```\n\nI've attached the code below, and I've started trying to profile the memory usage using the gems outlined in this excellent guide from Toptal:\nhttps://www.toptal.com/ruby/hunting-ruby-memory-issues\n\nIt looks like the memory usage is sailing to 3000MB while profiling? \n\nWhat can I do to reduce memory usage and move all this **** to Glacier? Previously, I had a bunch of small jobs, one for each photo_album, and it seemed to create fewer memory issues, but it could just be that some of our customers have larger video files to archive, some of them come in at like 80MB. \n\nCode snippets below:\n\n```\n  def schedule_media_archivals\n    photo_albums_for_archival.find_each(batch_size: 1000) do |photo_album|\n      photo_album.move_to_archive\n    end\n  end\n\n\n    def move_to_archive\n    return unless active?\n    # We might revisit the open_photo_album line below later but will turn it off for now, see BE-75\n    # return update_columns(archive_status: 4) if open_photo_album?\n\n    # If photo_album has no media, list it as restored so that archiving will ignore it and UI hides restore button\n    all_media_for_txn = all_media\n    return self.update_columns(archive_status: 3) if all_media_for_txn.empty?\n\n    all_media_for_txn.each do |media|\n      media.archive\n    end\n\n    # prevent \"user belongs to different Company\" error\n    self.update_columns(archive_status: 1) # :archived\n  end\n\n\n    def archive\n    return unless self.byte_size&amp;.nonzero? if has_attribute?(:byte_size)\n    storage_class = Rails.env == 'production' ? \"DEEP_ARCHIVE\" : \"GLACIER\"\n    return if self.class.to_s == 'Signature' &amp;&amp; self.media_store._type.to_s == \"MediaStores::S3Legacy\"\n    s3_objects.each do |obj|\n      begin\n        obj.put({\n          acl: \"public-read\",\n          body: obj.get.body.read,\n          content_length: obj.content_length,\n          content_type: obj.content_type,\n          storage_class: storage_class,\n        })\n      rescue Aws::S3::Errors::NoSuchKey =&gt; ex\n        Rails.logger.info \"Missing S3 Object: #{self.class}:#{id} #{url} #{ex}\"\n      rescue Aws::S3::Errors::InvalidObjectState =&gt; ex\n        Rails.logger.info \"Invalid S3 Object State: #{self.class}:#{id}\"\n      end\n    end\n    remove_thumbnail\n  end\n```", "author_fullname": "t2_j3r29", "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "How to optimize memory usage in Glacier Archiving?", "link_flair_richtext": [], "subreddit_name_prefixed": "r/rails", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "hide_score": false, "name": "t3_gikdj1", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.86, "author_flair_background_color": null, "subreddit_type": "public", "ups": 5, "total_awards_received": 0, "media_embed": {}, "author_flair_template_id": null, "is_original_content": false, "user_reports": [], "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 5, "approved_by": null, "author_premium": false, "thumbnail": "", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1589346251.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.rails", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;Hi all, &lt;/p&gt;\n\n&lt;p&gt;I&amp;#39;m currently running the following script against 2 million database rows in order to move the associated S3 resources to Deep Archive.&lt;/p&gt;\n\n&lt;p&gt;However, this process is causing our Kubernetes pods to crash and restart over and over, probably because I&amp;#39;m processing so much data in and out. &lt;/p&gt;\n\n&lt;p&gt;Look at the job pods failing:\n```\njobs-954db9b68-6qd5n                 1/1     Running     47         4d5h\njobs-954db9b68-9cmsf                 1/1     Running     249        2d14h\njobs-954db9b68-hz7jr                 1/1     Running     18         9h\njobs-954db9b68-kw8jd                 1/1     Running     182        2d14h\njobs-954db9b68-kw8vs                 1/1     Running     13         7h1m\njobs-954db9b68-mjnvs                 1/1     Running     3          7h1m\njobs-954db9b68-qwbw8                 1/1     Running     61         20h\njobs-954db9b68-sgmq2                 1/1     Running     11         14h\njobs-954db9b68-tx5nr                 1/1     Running     22         9h\njobs-954db9b68-vzcss                 1/1     Running     23         9h\njobs-954db9b68-w879w                 1/1     Running     22         20h\njobs-954db9b68-x9nc5                 1/1     Running     20         9h&lt;/p&gt;\n\n&lt;p&gt;```&lt;/p&gt;\n\n&lt;p&gt;I&amp;#39;ve attached the code below, and I&amp;#39;ve started trying to profile the memory usage using the gems outlined in this excellent guide from Toptal:\n&lt;a href=\"https://www.toptal.com/ruby/hunting-ruby-memory-issues\"&gt;https://www.toptal.com/ruby/hunting-ruby-memory-issues&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;It looks like the memory usage is sailing to 3000MB while profiling? &lt;/p&gt;\n\n&lt;p&gt;What can I do to reduce memory usage and move all this **** to Glacier? Previously, I had a bunch of small jobs, one for each photo_album, and it seemed to create fewer memory issues, but it could just be that some of our customers have larger video files to archive, some of them come in at like 80MB. &lt;/p&gt;\n\n&lt;p&gt;Code snippets below:&lt;/p&gt;\n\n&lt;p&gt;```\n  def schedule_media_archivals\n    photo_albums_for_archival.find_each(batch_size: 1000) do |photo_album|\n      photo_album.move_to_archive\n    end\n  end&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;def move_to_archive\nreturn unless active?\n# We might revisit the open_photo_album line below later but will turn it off for now, see BE-75\n# return update_columns(archive_status: 4) if open_photo_album?\n\n# If photo_album has no media, list it as restored so that archiving will ignore it and UI hides restore button\nall_media_for_txn = all_media\nreturn self.update_columns(archive_status: 3) if all_media_for_txn.empty?\n\nall_media_for_txn.each do |media|\n  media.archive\nend\n\n# prevent &amp;quot;user belongs to different Company&amp;quot; error\nself.update_columns(archive_status: 1) # :archived\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;end&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;def archive\nreturn unless self.byte_size&amp;amp;.nonzero? if has_attribute?(:byte_size)\nstorage_class = Rails.env == &amp;#39;production&amp;#39; ? &amp;quot;DEEP_ARCHIVE&amp;quot; : &amp;quot;GLACIER&amp;quot;\nreturn if self.class.to_s == &amp;#39;Signature&amp;#39; &amp;amp;&amp;amp; self.media_store._type.to_s == &amp;quot;MediaStores::S3Legacy&amp;quot;\ns3_objects.each do |obj|\n  begin\n    obj.put({\n      acl: &amp;quot;public-read&amp;quot;,\n      body: obj.get.body.read,\n      content_length: obj.content_length,\n      content_type: obj.content_type,\n      storage_class: storage_class,\n    })\n  rescue Aws::S3::Errors::NoSuchKey =&amp;gt; ex\n    Rails.logger.info &amp;quot;Missing S3 Object: #{self.class}:#{id} #{url} #{ex}&amp;quot;\n  rescue Aws::S3::Errors::InvalidObjectState =&amp;gt; ex\n    Rails.logger.info &amp;quot;Invalid S3 Object State: #{self.class}:#{id}&amp;quot;\n  end\nend\nremove_thumbnail\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;end\n```&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2qhjn", "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "gikdj1", "is_robot_indexable": true, "report_reasons": null, "author": "entwederoder", "discussion_type": null, "num_comments": 2, "send_replies": true, "whitelist_status": "all_ads", "contest_mode": false, "mod_reports": [], "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/rails/comments/gikdj1/how_to_optimize_memory_usage_in_glacier_archiving/", "parent_whitelist_status": "all_ads", "stickied": false, "url": "https://www.reddit.com/r/rails/comments/gikdj1/how_to_optimize_memory_usage_in_glacier_archiving/", "subreddit_subscribers": 43988, "created_utc": 1589317451.0, "num_crossposts": 0, "media": null, "is_video": false}}], "after": "t3_gikdj1", "before": null}}